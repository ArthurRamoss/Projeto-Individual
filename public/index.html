<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>F1TECH | Página Inicial</title>

    <script src="./js/sessao.js"></script>

    <link rel="stylesheet" href="./css/estilo.css">
    <link rel="icon" href="./assets/icon/favicon2.ico">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <style>
      /* Estilos para layout da história da Fórmula 1 */

      .section {
    background-color: #f9f9f9;
}

.section .container {
    margin: 0 auto;
    display: flex;
    align-items: center;
    flex-direction: column;
}

.section .content, .historia {
    max-width: 70%;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    margin-bottom: 20px;
}

.section .content {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: flex-start;
    width: 100%;
}

.section .info {
    display: flex;
    flex-direction: column;
    flex: 1;
}

.section .info h2 {
    color: #333;
    font-size: 50px;
    margin-bottom: 10px;
}

.section .info p {
    color: #666;
    font-size: 20px;
    line-height: 1.6;
    margin-bottom: 10px;
}

.img-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-left: 20px;
}

.images {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: row;
    margin-top: 10px;
}

.img-piloto {
    width: 300px;
    margin-bottom: 10px;
}

.logo-numero, .logo-equipe {
    max-width: 80px;
}

.section .historia {
    color: #666;
    font-size: 20px;
    line-height: 1.6;
    margin-top: -60px;
    width: 100%;
}
    </style>
</head>

<body>
    <div class="header">
      <div class="container">
        <img src="./assets/imgs/logo.png">
        <ul class="navbar">
          <li class="agora">
            <a href="#">Inicial</a>
          </li>
          <li>
            <a href="ranking.html">Ranking</a>
          </li>
          <li>|</li>
          <li>
            <a href="login.html">Login</a>
          </li>
          <li>
            <a href="cadastro.html">Cadastro</a>
          </li>
        </ul>
      </div>
    </div>
  
    <div class="banner">
      <div class="container">
        <p>Preservando <span>hoje</span> para existirem <span>amanhã</span>.</p>
        <a href="#history" class="button">Conheça mais sobre a história da Fórmula 1</a>
      </div>
    </div>
    
    <div id="piloto-template" class="section piloto">

    <!-- Conteúdo será preenchido via JavaScript -->
      <!-- <div class="container">
          <div class="content">
              <h2>Nome do Piloto</h2>
              <p><strong>Data de nascimento:</strong> XX/xx/xx </p>
              <p><strong>Numero:</strong> 38</p>
              <p><strong>Equipe Atual:</strong> Ferrari </p>
              <p><strong>Títulos:</strong> 0</p>
              <p><strong>História:</strong></p>
              <p>Born in the Mediterranean idyll of Monaco, Leclerc arrived in F1 on a tidal wave of expectation.

                Practically peerless on his way to the GP3 and Formula 2 crowns, he showcased a dazzling array of skills from scorching pole positions, commanding victories – even when his car caught fire twice at Silverstone – to an ability to muscle his way through the pack. Winning back-to-back championships also taught Leclerc how to handle pressure, another useful tool in the big pond of Formula 1 racing.
                
                Stepping up to F1 in 2018, Leclerc showed flashes of ballistic pace on Saturdays and racing brilliance on Sundays, dragging his Sauber beyond its limits – and earning himself a money-can’t-buy race seat at Ferrari for 2019, stepping into the shoes of the Scuderia’s last world champion, Kimi Raikkonen.</p>
          </div>
          <div class="images">
              <img src="https://media.formula1.com/d_driver_fallback_image.png/content/dam/fom-website/drivers/C/CHALEC01_Charles_Leclerc/chalec01.png" class="img-piloto">
              <img src="https://media.formula1.com/d_default_fallback_image.png/content/dam/fom-website/2018-redesign-assets/drivers/number-logos/CHALEC01.png" class="logo-numero">
              <img src="https://media.formula1.com/content/dam/fom-website/teams/2024/ferrari-logo.png" class="logo-equipe">
          </div>
      </div> -->
  </div>


    <div class="footer">
      <div class="container">
        <h4>Feito com amor por aluno &hearts; SPTech &copy; 2023</h4>
        <span class="version">v1.0.0</span>
      </div>
    </div>
  </body>

</html>

<script>
  document.addEventListener("DOMContentLoaded", async function () {
      try {
          // Chama as funções de listagem de pilotos e equipes e espera que ambas sejam concluídas
          await Promise.all([listarPilotos(), listarEquipes()]);
  
          // Após ambas as listas estarem preenchidas, preenche o template
          preencherTemplate();
      } catch (error) {
          console.error("Erro ao carregar dados:", error);
      }
  })
  
  let equipesData = {};
  
  function listarEquipes() {
      return fetch("/equipe/listarEquipe", {
          method: "GET",
      })
      .then(function (resposta) {
          return resposta.json();
      })
      .then((equipes) => {
          equipes.forEach((equipe) => {
              // Armazenar as informações das equipes em um objeto usando o ID da equipe como chave
              equipesData[equipe.idEquipe] = equipe;
          });
      })
      .catch(function (erro) {
          console.error(`#ERRO: ${erro}`);
      });
  }
  
  let pilotosData = [];
  
  function listarPilotos() {
      return fetch('/piloto/listarPiloto', {
          method: 'GET',
      })
      .then(function (resposta) {
          return resposta.json();
      })
      .then((pilotos) => {
          pilotosData = pilotos;
      })
      .catch(function (resposta) {
          console.log(`#ERRO: ${resposta}`);
      });
  }

  function formatarData(data) {
    // Função para formatar a data no formato desejado (XX/xx/xx)
    const dataObj = new Date(data);
    const dia = dataObj.getDate().toString().padStart(2, '0');
    const mes = (dataObj.getMonth() + 1).toString().padStart(2, '0');
    const ano = dataObj.getFullYear().toString();
    return `${dia}/${mes}/${ano}`;
}
  
function preencherTemplate() {
    const pilotoContainer = document.getElementById('piloto-template');
    pilotoContainer.innerHTML = ''; // Limpa o conteúdo do template

    pilotosData.forEach((piloto) => {
        // Verificar se o piloto tem uma equipe atribuída (fkEquipe)
        if (piloto.fkEquipe) {
            const equipe = equipesData[piloto.fkEquipe]; // Recupera os dados da equipe correspondente
            const pilotoDiv = document.createElement('div');
            pilotoDiv.classList.add('container');
            pilotoDiv.innerHTML = `
            <div class="content">
                    <div class="info">
                        <h2>${piloto.nome}</h2>
                        <p><strong>Data de nascimento:</strong> ${formatarData(piloto.dataNasc)}</p>
                        <p><strong>Numero:</strong> ${piloto.NumPiloto}</p>
                        <p><strong>Equipe Atual:</strong> ${equipe.nome}</p>
                        <p><strong>Títulos:</strong> ${piloto.titulos || 0}</p>
                    </div>
                    <div class="img-container">
                        <img src="${piloto.imgPiloto}" class="img-piloto">
                        <div class="images">
                            <img src="${piloto.imgNumPiloto}" class="logo-numero">
                            <img src="${equipe.logo}" class="logo-equipe">
                        </div>
                    </div>
                </div>
                <div class="historia">
                    <p><strong>História:</strong></p>
                    <p>${piloto.historia}</p>
                </div>
            `;
            pilotoContainer.appendChild(pilotoDiv);
        }
    });
}
  </script>
